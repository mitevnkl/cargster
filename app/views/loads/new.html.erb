<div class="shadow-sm rounded-3 sticky-top bg-white px-4 py-3">
  <div class="d-flex justify-content-between align-items-center">
    <%= link_to load_templates_path do %>
      <i class="fa fa-lg text-primary mx-1 fa-solid fa-chevron-left"></i>
    <% end %>
    <p class="fw-bolder m-0"><%= @page_name ||
      if current_page?(new_user_session_path)
        "Најава"
      elsif current_page?(new_user_registration_path)
        "Регистрација"
      elsif current_page?(new_user_password_path)
        "Заборавена лозинка"
      elsif current_page?(edit_user_registration_path)
        "Подесувања"
      end
    %></p>
    <button class="border-0 bg-white" style="background-color: rgb(244,244,244);" type="button" data-bs-toggle="collapse" data-bs-target="#collapseExample" aria-expanded="false" aria-controls="collapseExample">
      <i class="fa-solid fa-lg fa-bars text-primary" style=""></i>
    </button>
  </div>
</div>
<div class="collapse mx-3" id="collapseExample">
  <%= link_to "Почетна", root_path, class: "btn w-100 my-4" %>
  <% if !user_signed_in? %>
    <%= link_to "Најава", new_user_session_path, class: "btn mb-4 w-100" %>
    <%= link_to "Регистрација", new_user_registration_path, class: "btn mb-4 w-100" %>
  <% else %>
    <% if current_user.posts.count == 0 %>
      <%= link_to "Нов оглас", new_truck_path, class: "btn mb-4 w-100" %>
    <% else %>
      <%= link_to "Нов оглас", truck_templates_path, class: "btn mb-4 w-100" %>
    <% end %>
    <%= link_to "Мои огласи", trucks_path, class: "btn mb-4 w-100" %>
    <%= link_to "Подесувања", profile_path, class: "btn mb-4 w-100" %>
    <hr>
  <% end %>
</div>

<div class="container px-4 my-3">
  <%# display current url %>
  <% if !params[:truck_type].present? %>
  <%= render 'shared/tabs_new' %>
  <% end %>


  <%= simple_form_for @post do |f| %>
    <%= f.error_notification %>
    <%= f.error_notification message: f.object.errors[:base].to_sentence if f.object.errors[:base].present? %>

    <%= f.input :loading_date, placeholder: "Loading date", html5: true, label: "Датум на утовар", input_html: {class: "picker"} %>

    <%= f.input :truck_type, label: "Тип на камион", as: :check_boxes, input_html: { class: "tag-selector" },
                item_wrapper_class: 'tag-item', collection: [ "Церада", "Мега", "Хладнњача", "Цистерна", "Комбе", "Тандем", "АДР", "Камион(под 7.5т)" ] %>

    <div class="n-top">
      <%= f.input :length, label: "Должина", placeholder: "Метри" %>
    </div>

    <script>
      addEventListener("load", () => {
        var suggestionLists = document.getElementsByClassName("suggestions");
        setTimeout(() => {
          for (var i = 0; i < suggestionLists.length; i++) {
            suggestionLists[i].style.display = "none"
        }
        }, 200);
      });

    </script>

    <%= f.simple_fields_for :pickup, @post.pickup do |build| %>
      <%= build.input :place, label: "Преферирано место на утовар",
        input_html: {data: {address_autocomplete_target: "address"}, class:"d-none", },
        wrapper_html: {data: {controller: "address-autocomplete",
        address_autocomplete_api_key_value: ENV["MAPBOX_API_KEY"]}}
      %>
    <% end %>

    <%= f.simple_fields_for :dropoff, @post.dropoff do |build| %>
      <%= build.input :place, label: "Преферирано место на истовар",
        input_html: {data: {address_autocomplete_target: "address"}, class:"d-none"},
        wrapper_html: {data: {controller: "address-autocomplete",
        address_autocomplete_api_key_value: ENV["MAPBOX_API_KEY"]}}
      %>
    <% end %>

    <%= f.input :comment, label:"Коментар", id: "textarea", placeholder: "Нешто повеќе во врска со објавата" %>

    <%= f.submit 'Креирај', class: "btn btn-lg btn-primary w-100 text-white" %>

  <% end %>

</div>
